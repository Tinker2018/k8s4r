# Mosquitto MQTT Broker 配置文件
# 用于 K8s4r 开发和调试
# 兼容 Mosquitto 2.0

# 监听端口配置 - 明确指定监听器
listener 1883
allow_anonymous true
protocol mqtt

# WebSocket 支持（可选）
listener 9001
allow_anonymous true
protocol websockets

# 全局安全设置 - 开发环境允许匿名连接
# 注意：Mosquitto 2.0 需要在每个监听器上明确设置 allow_anonymous

# 日志配置
log_type all
log_dest stdout
log_timestamp true
connection_messages true

# 连接限制
max_connections -1
max_keepalive 65535

# 消息限制
message_size_limit 0
max_inflight_messages 20
max_queued_messages 100

# 持久化设置（开发环境可以关闭以提高性能）
persistence false

# 客户端会话设置
persistent_client_expiration 2h